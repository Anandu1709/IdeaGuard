{% extends "base.html" %}

{% block content %}
<div class="max-w-3xl mx-auto bg-white p-10 rounded-lg shadow-lg"> {# Increased padding and shadow #}
    <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">Project Risk Assessment</h2> {# Increased margin #}
    <p class="text-gray-600 mb-10 text-center"> {# Increased margin #}
        Fill out the form below to get a comprehensive risk assessment for your project or startup.
    </p>

    <form id="assessmentForm" class="space-y-6" enctype="multipart/form-data"> {# Adjusted space-y #}
        <div>
            <label for="projectName" class="block text-sm font-medium text-gray-700 mb-1">Project Name</label>
            <input type="text" id="projectName" name="projectName" required
                   class="input-field"> {# Using custom input-field class #}
        </div>

        <div>
            <label for="industry" class="block text-sm font-medium text-gray-700 mb-1">Industry</label>
            <select id="industry" name="industry" required
                    class="input-field"> {# Using custom input-field class #}
                <option value="">Select Industry</option>
                <option value="technology-software">Technology - Software Development</option>
                <option value="technology-hardware">Technology - Hardware/IoT</option>
                <option value="e-commerce-retail">E-commerce - Retail</option>
                <option value="e-commerce-marketplace">E-commerce - Marketplace</option>
                <option value="fintech-payments">Fintech - Payments/Banking</option>
                <option value="fintech-investments">Fintech - Investments/Wealth Management</option>
                <option value="healthcare-biotech">Healthcare - Biotech/Pharma</option>
                <option value="healthcare-digital">Healthcare - Digital Health/Telemedicine</option>
                <option value="education-edtech">Education - EdTech</option>
                <option value="education-traditional">Education - Traditional Institutions</option>
                <option value="manufacturing-automotive">Manufacturing - Automotive</option>
                <option value="manufacturing-consumer">Manufacturing - Consumer Goods</option>
                <option value="food-beverage">Food & Beverage</option>
                <option value="real-estate">Real Estate</option>
                <option value="media-entertainment">Media & Entertainment</option>
                <option value="travel-hospitality">Travel & Hospitality</option>
                <option value="energy-renewables">Energy - Renewables</option>
                <option value="agriculture">Agriculture</option>
                <option value="consulting">Consulting</option>
                <option value="non-profit">Non-Profit</option>
                <option value="other">Other</option>
            </select>
        </div>

        <div>
            <label for="description" class="block text-sm font-medium text-gray-700 mb-1">Project Description</label>
            <textarea id="description" name="description" rows="4" required
                      class="input-field"></textarea> {# Using custom input-field class #}
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6"> {# Increased gap #}
            <div>
                <label for="budget" class="block text-sm font-medium text-gray-700 mb-1">Estimated Budget (INR)</label>
                <input type="number" id="budget" name="budget" required min="0"
                       class="input-field"> {# Using custom input-field class #}
            </div>
            <div>
                <label for="timeline" class="block text-sm font-medium text-gray-700 mb-1">Project Timeline</label>
                <select id="timeline" name="timeline" required
                        class="input-field"> {# Using custom input-field class #}
                    <option value="">Select Timeline</option>
                    <option value="1-3months">1-3 Months</option>
                    <option value="3-6months">3-6 Months</option>
                    <option value="6-12months">6-12 Months</option>
                    <option value="1-2years">1-2 Years</option>
                    <option value="2+years">2+ Years</option>
                </select>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6"> {# Increased gap #}
            <div>
                <label for="location" class="block text-sm font-medium text-gray-700 mb-1">Geographic Scope</label>
                <select id="location" name="location" required
                        class="input-field"> {# Using custom input-field class #}
                    <option value="">Select Scope</option>
                    <option value="local">Local (City/Region)</option>
                    <option value="country">Country-wide</option>
                    <option value="global">Global</option>
                </select>
            </div>
            <div>
                <label for="numberOfCofounders" class="block text-sm font-medium text-gray-700 mb-1">Number of Co-founders</label>
                <input type="number" id="numberOfCofounders" name="numberOfCofounders" required min="1"
                       class="input-field"> {# Using custom input-field class #}
            </div>
        </div>

        <div>
            <label for="technicalComplexity" class="block text-sm font-medium text-gray-700 mb-1">Technical Complexity (1-10)</label>
            <input type="range" id="technicalComplexity" name="technicalComplexity" min="1" max="10" value="5"
                   class="mt-1 block w-full accent-red-600"> {# Added accent-red-600 #}
            <div class="text-right text-sm text-gray-500 mt-1">Value: <span id="complexityValue">5</span></div> {# Increased margin #}
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6"> {# Increased gap #}
            <div>
                <label for="totalRevenue" class="block text-sm font-medium text-gray-700 mb-1">Expected Total Revenue (INR)</label>
                <input type="number" id="totalRevenue" name="totalRevenue" required min="0"
                       class="input-field"> {# Using custom input-field class #}
            </div>
            <div>
                <label for="totalExpense" class="block text-sm font-medium text-gray-700 mb-1">Expected Total Expense (INR)</label>
                <input type="number" id="totalExpense" name="totalExpense" required min="0"
                       class="input-field"> {# Using custom input-field class #}
            </div>
        </div>

        <div>
            <label for="resumes" class="block text-sm font-medium text-gray-700 mb-1">Upload Resumes (PDF only, optional)</label>
            <input type="file" id="resumes" name="resumes" accept=".pdf" multiple
                   class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-red-50 file:text-red-700 hover:file:bg-red-100"> {# Red file input #}
            <p class="mt-1 text-xs text-gray-500">Max file size: 16MB per file.</p>
        </div>

        <div>
            <button type="submit"
                    class="btn-primary w-full"> {# Using custom btn-primary class #}
                Submit Assessment
            </button>
        </div>
    </form>
</div>

<script>
    document.getElementById('assessmentForm').addEventListener('submit', async function(event) {
        event.preventDefault();

        const formData = new FormData(this);
        const submitButton = this.querySelector('button[type="submit"]');
        submitButton.disabled = true;
        submitButton.textContent = 'Submitting...';

        try {
            const response = await fetch('/api/submit-assessment', {
                method: 'POST',
                body: formData
            });

            const result = await response.json();

            if (response.ok) {
                alert('Assessment submitted successfully!');
                window.location.href = '/results'; // Redirect to results page
            } else {
                alert('Error submitting assessment: ' + (result.error || 'Unknown error'));
            }
        } catch (error) {
            console.error('Fetch error:', error);
            alert('Network error or server issue. Please try again.');
        } finally {
            submitButton.disabled = false;
            submitButton.textContent = 'Submit Assessment';
        }
    });
</script>
{% endblock %}
